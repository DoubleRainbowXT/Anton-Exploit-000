#!/bin/bash

REGISTER_ENDPOINT="https://d-apis-db.anton.app/?p=learnList/create/create"

# Ask the user to input the main text
read -p "Enter main text: " MAIN_TEXT

# Ask the user to input the title
read -p "Enter title: " TITLE

# Ask the user to input the normal logId
read -p "Enter normal logId: " NORMAL_LOG_ID

# Ask the user to input the device log id
read -p "Enter device log id: " DEVICE_LOG_ID

# Ask the user to input the auth token
read -p "Enter auth token: " AUTH_TOKEN

while true; do
    # Generate a random number for appending to the title
    RANDOM_NUMBER=$(shuf -i 10000-99999 -n 1)

    # Combine the title and random number
    RANDOM_NAME="${TITLE} - ${RANDOM_NUMBER}"

    # Send the curl request with the user-provided values
    curl "${REGISTER_ENDPOINT}" \
        -H 'authority: d-apis-db.anton.app' \
        -H 'accept: */*' \
        -H 'accept-language: en,de-DE;q=0.9,de;q=0.8' \
        -H 'content-type: application/json' \
        -H 'origin: https://anton.app' \
        -H 'sec-ch-ua: "Not_A Brand";v="8", "Chromium";v="120", "Google Chrome";v="120"' \
        -H 'sec-ch-ua-mobile: ?0' \
        -H 'sec-ch-ua-platform: "Chrome OS"' \
        -H 'sec-fetch-dest: empty' \
        -H 'sec-fetch-mode: cors' \
        -H 'sec-fetch-site: same-site' \
        -H 'user-agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36' \
        --data-raw "{\"params\":{\"name\":\"${RANDOM_NAME}\",\"type\":\"vocabEnDe\",\"items\":[{\"a\":{\"text\":\"${TITLE}\"},\"b\":{\"text\":\"${MAIN_TEXT}\"}}]},\"path\":\"/../server-apis-db2/apis/learnList/create/create\",\"logId\":\"${NORMAL_LOG_ID}\",\"deviceLogId\":\"${DEVICE_LOG_ID}\",\"isDebug\":false,\"useAuthToken\":true,\"authToken\":\"${AUTH_TOKEN}\"}" \
        --compressed
done
